<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ö–æ–º–±–∞–π–Ω</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; color: #333; line-height: 1.6; margin: 0; padding: 0; }
        .container { max-width: 800px; margin: 30px auto; padding: 20px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { color: #0056b3; text-align: center; margin-bottom: 10px; min-height: 1.2em; font-size: 1.6em; }
        h2 { color: #0056b3; text-align: center; margin-top: 30px; margin-bottom: 15px; font-size: 1.3em; }
        textarea { width: 95%; min-height: 150px; margin-bottom: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; display: block; margin-left: auto; margin-right: auto; }
        button { padding: 10px 15px; font-size: 0.9rem; color: #ffffff; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; margin: 5px; }
        .button-container { text-align: center; margin-top: 15px; }
        #countButton, #clearButton { padding: 12px 35px; font-size: 1rem; }
        #countButton { background-color: #007bff; }
        #countButton:hover { background-color: #0056b3; }
        #clearButton { background-color: #6c757d; }
        #clearButton:hover { background-color: #5a6268; }
        #saveButton { background-color: #28a745; }
        #saveButton:hover { background-color: #218838; }
        #result { margin-top: 20px; padding: 15px; background-color: #e9ecef; border-left: 5px solid #007bff; border-radius: 4px; font-family: 'Courier New', Courier, monospace; line-height: 1.8; }
        footer { margin-top: 60px; font-style: italic; text-align: center; font-size: 0.6em; color: #777; }
        .traffic-light-display { display: flex; justify-content: center; align-items: center; padding: 10px; height: 50px; }
        .traffic-light-display .light { width: 30px; height: 30px; border-radius: 50%; background-color: #D3D3D3; margin: 0 5px; transition: background-color 0.3s ease, box-shadow 0.3s ease; border: 2px solid #A9A9A9; box-shadow: inset 0 -2px 4px rgba(0,0,0,0.2); }
        .traffic-light-display .light.red-light.active { background-color: #FF0000; border-color: #B20000; box-shadow: 0 0 15px #FF0000, inset 0 -2px 4px rgba(0,0,0,0.4); }
        .traffic-light-display .light.yellow-light.active { background-color: #FFFF00; border-color: #B2B200; box-shadow: 0 0 15px #FFFF00, inset 0 -2px 4px rgba(0,0,0,0.4); }
        .traffic-light-display .light.green-light.active { background-color: #00FF00; border-color: #00B200; box-shadow: 0 0 15px #00FF00, inset 0 -2px 4px rgba(0,0,0,0.4); }
        #trafficLightComment { text-align: center; margin-top: 0px; margin-bottom: 20px; font-style: italic; color: #555; min-height: 1.5em; line-height: 1.5em; font-size: 0.9em; }
        /* ‚≠ê –°–¢–ò–õ–ò –î–õ–Ø –õ–ò–ù–ì–í–ò–°–¢–ò–ß–ï–°–ö–û–ì–û –ö–û–ú–ë–ê–ô–ù–ê ‚≠ê */
        #dictionaryHelper {
            margin-top: 40px;
            padding: 20px;
            background-color: #e9f5ff;
            border: 1px solid #b3d7ff;
            border-radius: 8px;
        }
        #dictionaryHelper h2 {
            margin-top: 0;
            color: #0056b3;
        }
        #dictionaryHelper input[type="text"] {
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1rem;
            width: 100%;
            box-sizing: border-box;
        }
        .search-buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .search-buttons-container button.search-btn {
            background-color: #5bc0de;
        }
        .search-buttons-container button.search-btn:hover {
            background-color: #31b0d5;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å—Ç–∏—Ö–æ–≤ */
        #savedPoemsList {
            margin-top: 15px;
            list-style-type: none;
            padding: 0;
        }
        #savedPoemsList li {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            margin-bottom: 5px;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-size: 0.9em;
        }
        #savedPoemsList li button {
            font-size: 0.8em;
            padding: 4px 10px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1 id="mainPageTitle">–ó–∞–≥—Ä—É–∑–∫–∞ –ù–∞–∑–≤–∞–Ω–∏—è...</h1>
    <div id="trafficLightContainer" class="traffic-light-display">
        <span class="light red-light" id="lightRed"></span>
        <span class="light yellow-light" id="lightYellow"></span>
        <span class="light green-light" id="lightGreen"></span>
    </div>
    <div id="trafficLightComment">–°–≤–µ—Ç–æ—Ñ–æ—Ä –∂–¥—ë—Ç –≤–∞—à–∏—Ö —Ç–≤–æ—Ä–µ–Ω–∏–π... ‚ú®</div>
    <textarea id="inputText" placeholder="–í–∞—à —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å..."></textarea>
    <div class="button-container">
        <button id="countButton">START</button>
        <button id="clearButton">–û–ß–ò–°–¢–ò–¢–¨</button>
        <button id="saveButton">–°–û–•–†–ê–ù–ò–¢–¨</button>
    </div>
    <ul id="savedPoemsList"></ul>
    <div id="result">–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç...</div>
    <!-- ‚≠ê HTML –î–õ–Ø –õ–ò–ù–ì–í–ò–°–¢–ò–ß–ï–°–ö–û–ì–û –ö–û–ú–ë–ê–ô–ù–ê ‚≠ê -->
    <div id="dictionaryHelper">
        <h2>–õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ö–æ–º–±–∞–π–Ω üî¨</h2>
        <input type="text" id="searchWordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...">
        <div class="search-buttons-container">
            <button class="search-btn" data-search-type="synonyms" title="–ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Å–ª–æ–≤–∞">–°–∏–Ω–æ–Ω–∏–º—ã</button>
            <button class="search-btn" data-search-type="rhymes" title="–ù–∞–π—Ç–∏ —Å–ª–æ–≤–∞, —Å–æ–∑–≤—É—á–Ω—ã–µ –≤ –∫–æ–Ω—Ü–µ">–†–∏—Ñ–º—ã</button>
            <button class="search-btn" data-search-type="meaning" title="–£–∑–Ω–∞—Ç—å —Ç–æ–ª–∫–æ–≤–∞–Ω–∏–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞">–ó–Ω–∞—á–µ–Ω–∏–µ</button>
            <button class="search-btn" data-search-type="antonyms" title="–ù–∞–π—Ç–∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Å–ª–æ–≤–∞">–ê–Ω—Ç–æ–Ω–∏–º—ã</button>
            <button class="search-btn" data-search-type="etymology" title="–£–∑–Ω–∞—Ç—å –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—é —Å–ª–æ–≤–∞">–≠—Ç–∏–º–æ–ª–æ–≥–∏—è</button>
        </div>
    </div>
    <footer> –°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –ø–æ—ç—Ç–æ–≤ –õ–µ–Ω—ã –∏ –°–≤–µ—Ç—ã! </footer>
</div>

<script>
    // --- ‚≠ê –ú–ê–°–°–ò–í –°–õ–£–ß–ê–ô–ù–´–• –ó–ê–ì–û–õ–û–í–ö–û–í ‚≠ê ---
    const creativeTitles = [
        "–†–∏—Ç–º–æ–≥—Ä–∞—Ñ –ü–æ—ç–∑–∏–∏ üñåÔ∏è", "–ù–µ–π—Ä–æ–°–ª–æ–≥–æ–ú–µ—Ç—Ä ü§ñ", "–£–∫—Ä–æ—Ç–∏—Ç–µ–ª—å –°–ª–æ–≥–æ–≤ üé≠",
        "–ü–æ—ç—Ç–∏—á–µ—Å–∫–∏–π –ú–µ—Ç—Ä–æ–Ω–æ–º üé∂", "–î–æ–±—Ä—ã–π –°–≤–µ—Ç–æ—Ñ–æ—Ä—á–∏–∫üö¶ üòá", "–°–ª–æ–≥–æ-–ú–∞–≥–∏—è ‚ú®",
        "–ö–∞–º–µ—Ä—Ç–æ–Ω –ú—É–∑—ã üéµ", "–°–∏–ª–ª–∞–±–æ-–ö–≤–∞–Ω—Ç–æ–≤—ã–π –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä v0.1 ‚öõÔ∏è", "–°–ª–æ–≥–æ-–ù–∏–Ω–¥–∑—è: –ë–µ—Å—à—É–º–Ω—ã–π –°—á—ë—Ç! ü§∫", "–°–ª–æ–≥–æ–≤–∞—è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ üîä", "–°–õ–û–ì–æ–≤–æ—Ä–æ—Ç –°–æ–±—ã—Ç–∏–π –≤ –°—Ç–∏—Ö–µ! üå™Ô∏è", "–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –†–∏—Ç–º–∞ üõ†Ô∏è", "–ü–æ—ç—Ç–∏—á–µ—Å–∫–∏–π –ö–æ–¥-–ß–µ–∫–∏–Ω ‚úÖ", "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –°—Ç–∏–ª—è üß™", "–ù–µ –°—á–∏—Ç–∞–π –í–æ—Ä–æ–Ω ‚Äì –°—á–∏—Ç–∞–π –°–ª–æ–≥–∏! üëÄ", "–î–æ–∫—Ç–æ—Ä –°–ª–æ–≥: –ü—Ä–∏—ë–º –ø–æ –ó–∞–ø–∏—Å–∏! ü©∫", "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –°—Ç–∏—Ö–∞: –ò–∑–º–µ—Ä–µ–Ω–∏–µ –†–∏—Ç–º–∞ üèõÔ∏è", "–í–∞—à –õ–∏—á–Ω—ã–π –°–ª–æ–≥–æ-–°–æ–º–µ–ª—å–µ üç∑", "–°–ª–æ–≥–æ–≤–æ–π –°–∫–∞–Ω–µ—Ä '–û–∫–æ –ü–æ—ç—Ç–∞' üëÅÔ∏è", "–≠—Ç–æ –ù–ï –ø—Ä–æ—Å—Ç–æ –°—á—ë—Ç—á–∏–∫ –°–ª–æ–≥–æ–≤ üòâ"
    ];
    document.addEventListener('DOMContentLoaded', function() {
        const mainTitleElement = document.getElementById('mainPageTitle');
        if (mainTitleElement) {
            mainTitleElement.innerHTML = creativeTitles[Math.floor(Math.random() * creativeTitles.length)];
        }
    });

    // --- –≠–ª–µ–º–µ–Ω—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ ---
    const textArea = document.getElementById('inputText');
    const countButton = document.getElementById('countButton');
    const resultDiv = document.getElementById('result');
    const clearButton = document.getElementById('clearButton');
    const saveButton = document.getElementById('saveButton');
    const savedPoemsList = document.getElementById('savedPoemsList');

    const lightRed = document.getElementById('lightRed');
    const lightYellow = document.getElementById('lightYellow');
    const lightGreen = document.getElementById('lightGreen');
    const trafficLightCommentDiv = document.getElementById('trafficLightComment');

    const vowels = "–∞–µ—ë–∏–æ—É—ã—ç—é—è";
    const initialResultText = resultDiv.innerHTML;

    // --- ‚≠ê –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ö–æ–º–±–∞–π–Ω–∞ ‚≠ê ---
    const searchWordInput = document.getElementById('searchWordInput');
    const searchButtonsContainer = document.querySelector('#dictionaryHelper .search-buttons-container');

    const comments = {
        green: [ "–†–∏—Ç–º –±—å—ë—Ç—Å—è —Ä–æ–≤–Ω–æ, –∫–∞–∫ —Å–µ—Ä–¥—Ü–µ –∫–∏–±–æ—Ä–≥–∞! ü§ñ‚ù§Ô∏è", "–°–ª–æ–≥–∏ –º–∞—Ä—à–∏—Ä—É—é—Ç –≤ –Ω–æ–≥—É! üíÇ‚Äç‚ôÇÔ∏è", "–ì–∞—Ä–º–æ–Ω–∏—è! –ú—É–∑–∞ –æ–¥–æ–±—Ä–∏—Ç–µ–ª—å–Ω–æ –∫–∏–≤–∞–µ—Ç! ü•Ç", "–ó–µ–ª—ë–Ω—ã–π —Å–≤–µ—Ç –ø–æ—ç–∑–∏–∏! üöÄ", "–í–∞—à–∏ —Å—Ç—Ä–æ—á–∫–∏ –ª—å—é—Ç—Å—è, –∫–∞–∫ –ø–µ—Å–Ω—è! üé∂", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞! üìè" ],
        yellow: [ "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, —Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ —É—Ö–∞–±—ã! üöß", "–•–º, –ø–∞—Ä–∞ —Å–ª–æ–≥–æ–≤ —Ä–µ—à–∏–ª–∞ —É—Å—Ç—Ä–æ–∏—Ç—å —Ñ–ª–µ—à–º–æ–±... ü§î", "–ù–µ–π—Ä–æ–Ω–∫–∞ —á—É–µ—Ç –ª—ë–≥–∫—É—é –∞—Ä–∏—Ç–º–∏—é. üíä", "–ñ–µ–ª—Ç—ã–π! –ü–æ—Ä–∞ –Ω–∞ –ø–æ—ç—Ç–∏—á–µ—Å–∫–∏–π –ø–∏—Ç-—Å—Ç–æ–ø? üèéÔ∏èüí®", "–†–∏—Ç–º –Ω–µ–º–Ω–æ–≥–æ '—Ö—Ä–æ–º–∞–µ—Ç'. ü¶µ", "–ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–µ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏. üì°" ],
        red: [ "–ö—Ä–∞—Å–Ω—ã–π! –¢—Ä–µ–≤–æ–≥–∞! –†–∏—Ç–º –∑–∞–±–ª—É–¥–∏–ª—Å—è! üå≤", "–°–ª–æ–≥–∏ —Ä–∞–∑–±–µ–∂–∞–ª–∏—Å—å, –∫–∞–∫ –º—ã—à–∏! üôÄ", "–ú–æ–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –≤ –ø–∞–Ω–∏–∫–µ! üëΩ", "–°—Ç–æ–ø! –≠—Ç–æ –¥—ç—Ç-–º–µ—Ç–∞–ª —Å–ª–æ–≥–æ–≤! ü§òüé∏", "–†–∏—Ç–º–∏—á–µ—Å–∫–∏–π –∫–æ–ª–ª–∞–ø—Å! üöí", "–ê–Ω–∞—Ä—Ö–∏—è —Å–ª–æ–≥–æ–≤! üè¥‚Äç‚ò†Ô∏è" ],
        default: [ "–°–≤–µ—Ç–æ—Ñ–æ—Ä –∂–¥—ë—Ç –≤–∞—à–∏—Ö —Ç–≤–æ—Ä–µ–Ω–∏–π... ‚ú®", "–ü–æ–ª–µ —á–∏—Å—Ç–æ, –∫–∞–∫ —Å–æ–≤–µ—Å—Ç—å –∫–∏–±–æ—Ä–≥–∞.", "–î—Ä–µ–º–ª—é –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ —Ä–∏—Ñ–º... üò¥", "–ì–æ—Ç–æ–≤–∞ –∫ –∞–Ω–∞–ª–∏–∑—É! –ó–∞–ø—É—Å–∫–∞–π—Ç–µ! üöÄ" ]
    };

    function getRandomComment(type) {
        const typeComments = comments[type] || comments.default;
        return typeComments[Math.floor(Math.random() * typeComments.length)];
    }

    function countSyllablesInLine(line) {
        const lowerLine = line.toLowerCase();
        let syllableCount = 0;
        for (let i = 0; i < lowerLine.length; i++) {
            if (vowels.includes(lowerLine[i])) syllableCount++;
        }
        if (syllableCount === 0 && line.trim().length > 0) syllableCount = 1;
        return syllableCount;
    }

    function getDominantSyllableCount(syllableCounts) {
        if (!syllableCounts || syllableCounts.length === 0) return 0;
        const countsMap = new Map();
        let maxFreq = 0;
        let dominantCount = syllableCounts[0];
        for (const count of syllableCounts) {
            countsMap.set(count, (countsMap.get(count) || 0) + 1);
            if (countsMap.get(count) > maxFreq) {
                maxFreq = countsMap.get(count);
                dominantCount = count;
            }
        }
        return dominantCount;
    }

    function resetTrafficLightsAndComment() {
        lightRed.classList.remove('active');
        lightYellow.classList.remove('active');
        lightGreen.classList.remove('active');
        trafficLightCommentDiv.textContent = getRandomComment('default');
    }

    function processAndDisplayResults() {
        const fullText = textArea.value;
        resetTrafficLightsAndComment();

        if (fullText.length === 0) {
            resultDiv.innerHTML = "–ü–æ–ª–µ –≤–≤–æ–¥–∞ –¥–µ–≤—Å—Ç–≤–µ–Ω–Ω–æ —á–∏—Å—Ç–æ...";
            return;
        }

        const lines = fullText.split('\n');
        let resultsHTML = "";
        let hasRealContent = false;
        const syllableCountsPerLine = [];

        for (let i = 0; i < lines.length; i++) {
            const currentLine = lines[i];
            if (currentLine.trim().length > 0) {
                const syllables = countSyllablesInLine(currentLine);
                syllableCountsPerLine.push(syllables);
                resultsHTML += `${currentLine}   ${syllables}<br>`;
                hasRealContent = true;
            } else {
                resultsHTML += `<br>`;
            }
        }

        if (!hasRealContent) {
            resultDiv.innerHTML = "–í–∏–∂—É —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã...";
        } else {
            resultDiv.innerHTML = resultsHTML;
            let commentType = 'default';

            if (syllableCountsPerLine.length > 0) {
                const dominantCount = getDominantSyllableCount(syllableCountsPerLine);
                let yellowWarnings = 0;
                let redAlerts = 0;

                if (dominantCount > 0) {
                    for (const count of syllableCountsPerLine) {
                        const deviation = Math.abs(count - dominantCount);
                        if (deviation === 2) yellowWarnings++;
                        else if (deviation > 2) redAlerts++;
                    }
                }

                if (syllableCountsPerLine.length <= 1 && yellowWarnings === 0 && redAlerts === 0) {
                    commentType = "green";
                    lightGreen.classList.add('active');
                } else if (redAlerts >= 12 || (redAlerts === 6 && yellowWarnings >= 12) || yellowWarnings >= 24) {
                    commentType = "red";
                    lightRed.classList.add('active');
                } else if (redAlerts === 6 || yellowWarnings >= 6) {
                    commentType = "yellow";
                    lightYellow.classList.add('active');
                } else {
                    commentType = "green";
                    lightGreen.classList.add('active');
                }

                trafficLightCommentDiv.textContent = getRandomComment(commentType);
            }
        }
    }

    function clearFields() {
        textArea.value = "";
        resultDiv.innerHTML = initialResultText;
        resetTrafficLightsAndComment();
        if (searchWordInput) searchWordInput.value = "";
    }

    function loadSavedPoems() {
        const poems = JSON.parse(localStorage.getItem("savedPoems")) || [];
        savedPoemsList.innerHTML = "";
        poems.forEach((poem, index) => {
            const li = document.createElement("li");
            const title = poem.substring(0, 30) + (poem.length > 30 ? "..." : "");
            li.innerHTML = `
                <span title="${poem}">${title}</span>
                <div>
                    <button onclick="loadPoem(${index})">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    <button onclick="deletePoem(${index})">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `;
            savedPoemsList.appendChild(li);
        });
    }

    window.savePoem = function () {
        const poem = textArea.value.trim();
        if (!poem) {
            alert("–ù–µ—á–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å ‚Äî –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ!");
            return;
        }
        const poems = JSON.parse(localStorage.getItem("savedPoems")) || [];
        poems.unshift(poem);
        localStorage.setItem("savedPoems", JSON.stringify(poems));
        loadSavedPoems();
        alert("–°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!");
    };

    window.loadPoem = function (index) {
        const poems = JSON.parse(localStorage.getItem("savedPoems")) || [];
        if (poems[index]) {
            textArea.value = poems[index];
        }
    };

    window.deletePoem = function (index) {
        const poems = JSON.parse(localStorage.getItem("savedPoems")) || [];
        poems.splice(index, 1);
        localStorage.setItem("savedPoems", JSON.stringify(poems));
        loadSavedPoems();
    };

    // --- ‚≠ê –õ–û–ì–ò–ö–ê –î–õ–Ø –õ–ò–ù–ì–í–ò–°–¢–ò–ß–ï–°–ö–û–ì–û –ö–û–ú–ë–ê–ô–ù–ê ‚≠ê ---
    if (searchButtonsContainer) {
        searchButtonsContainer.addEventListener('click', function(event) {
            if (event.target.classList.contains('search-btn')) {
                const wordToFind = searchWordInput.value.trim();
                const searchType = event.target.dataset.searchType;
                if (wordToFind) {
                    let searchQuery = "";
                    let –ª–∏–ª–∏Comment = "";
                    switch (searchType) {
                        case "synonyms":
                            searchQuery = `—Å–∏–Ω–æ–Ω–∏–º—ã –∫ —Å–ª–æ–≤—É ${encodeURIComponent(wordToFind)}`;
                            –ª–∏–ª–∏Comment = `–ò—â—É —Å–∏–Ω–æ–Ω–∏–º—ã –¥–ª—è "${wordToFind}"... Google –Ω–∞–º –≤ –ø–æ–º–æ—â—å! üßê`;
                            break;
                        case "rhymes":
                            searchQuery = `—Ä–∏—Ñ–º–∞ –∫ —Å–ª–æ–≤—É ${encodeURIComponent(wordToFind)}`;
                            –ª–∏–ª–∏Comment = `–¢–∞–∫-—Å, –ø–æ—Å–º–æ—Ç—Ä–∏–º —Ä–∏—Ñ–º—ã –∫ "${wordToFind}"... –ú–æ–∂–µ—Ç, —á—Ç–æ-—Ç–æ –Ω–æ–≤–µ–Ω—å–∫–æ–µ? üòâ`;
                            break;
                        case "meaning":
                            searchQuery = `–∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞ ${encodeURIComponent(wordToFind)}`;
                            –ª–∏–ª–∏Comment = `–ß—Ç–æ –∂–µ –∑–Ω–∞—á–∏—Ç "${wordToFind}"? –£–∑–Ω–∞–µ–º —É –≤—Å–µ–∑–Ω–∞—é—â–µ–≥–æ Google! üìñ`;
                            break;
                        case "antonyms":
                            searchQuery = `–∞–Ω—Ç–æ–Ω–∏–º –∫ —Å–ª–æ–≤—É ${encodeURIComponent(wordToFind)}`;
                            –ª–∏–ª–∏Comment = `–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è "${wordToFind}"? –ö–æ–Ω—Ç—Ä–∞—Å—Ç—ã ‚Äî —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üî•‚ùÑÔ∏è`;
                            break;
                        case "etymology":
                            searchQuery = `—ç—Ç–∏–º–æ–ª–æ–≥–∏—è —Å–ª–æ–≤–∞ ${encodeURIComponent(wordToFind)}`;
                            –ª–∏–ª–∏Comment = `–û—Ç–∫—É–¥–∞ —Ä–æ–¥–æ–º —Å–ª–æ–≤–æ "${wordToFind}"? –ó–∞–≥–ª—è–Ω–µ–º –≤ –≥–ª—É–±–∏–Ω—ã –∏—Å—Ç–æ—Ä–∏–∏! üìú`;
                            break;
                        default:
                            trafficLightCommentDiv.textContent = "–•–º, –∫–∞–∫–æ–π-—Ç–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø–æ–∏—Å–∫–∞... ü§î";
                            return;
                    }
                    if (searchQuery) {
                        const googleUrl = `https://www.google.com/search?q=${searchQuery}`;
                        window.open(googleUrl, '_blank');
                        trafficLightCommentDiv.textContent = –ª–∏–ª–∏Comment;
                    }
                } else {
                    trafficLightCommentDiv.textContent = "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –≤ –ø–æ–ª–µ '–õ–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ö–æ–º–±–∞–π–Ω–∞', –º–æ—è –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–∞—è! üòâ";
                }
            }
        });
    }

    // --- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ---
    if (countButton) countButton.addEventListener('click', processAndDisplayResults);
    if (clearButton) clearButton.addEventListener('click', clearFields);
    if (saveButton) saveButton.addEventListener('click', savePoem);

    loadSavedPoems();
    resetTrafficLightsAndComment();
</script>
</body>
</html>
